# Schema definitions for log datasets

common_fields:
  timestamp:
    type: datetime
    format: "%Y-%m-%d %H:%M:%S.%f"
    required: true
    nullable: false
  
  component:
    type: string
    max_length: 100
    required: true
    nullable: false
  
  severity:
    type: enum
    values: ["INFO", "WARNING", "ERROR", "CRITICAL", "DEBUG"]
    required: true
    default: "INFO"
  
  message:
    type: string
    required: true
    nullable: false

hdfs_fields:
  block_id:
    type: string
    pattern: "blk_\\d+"
    required: false
    nullable: true
  
  node_id:
    type: string
    pattern: "(data|name)node_\\w+"
    required: false
    nullable: true

apache_fields:
  http_method:
    type: enum
    values: ["GET", "POST", "PUT", "DELETE", "HEAD", "OPTIONS", "PATCH"]
    required: true
    nullable: false
  
  status_code:
    type: integer
    min: 100
    max: 599
    required: true
    nullable: false
  
  url:
    type: string
    required: true
    nullable: false

healthapp_fields:
  user_id:
    type: string
    pattern: "user_[a-f0-9]+"
    required: true
    nullable: false
  
  action_type:
    type: enum
    values: ["login", "logout", "data_access", "settings_change", "error"]
    required: true
    nullable: false
  
  session_duration:
    type: float
    min: 0
    required: false
    nullable: true

ssh_fields:
  session_id:
    type: string
    pattern: "session_[a-zA-Z0-9]+"
    required: true
    nullable: false
  
  auth_type:
    type: enum
    values: ["password", "key", "certificate"]
    required: true
    nullable: false
  
  source_ip:
    type: string
    pattern: "\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}"
    required: true
    nullable: false
    anonymize: true

validation_rules:
  timestamp:
    - rule: not_future
      message: "Timestamp cannot be in the future"
    - rule: not_too_old
      params: {"max_age_days": 365}
      message: "Timestamp cannot be more than 1 year old"
  
  severity:
    - rule: severity_distribution
      params: {"max_error_rate": 0.1}
      message: "Error rate exceeds threshold"
  
  message:
    - rule: min_length
      params: {"min_length": 10}
      message: "Message too short"
    - rule: max_length
      params: {"max_length": 1000}
      message: "Message too long"

feature_extraction:
  temporal:
    - name: hour_of_day
      type: int
      range: [0, 23]
    - name: day_of_week
      type: int
      range: [0, 6]
    - name: is_weekend
      type: bool
  
  message:
    - name: message_length
      type: int
    - name: word_count
      type: int
    - name: contains_error_keywords
      type: bool
  
  patterns:
    - name: template_id
      type: string
    - name: variable_count
      type: int
    - name: pattern_frequency
      type: float 